<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="~{fragments/head}"></th:block>
</head>
<body>
<header>
    <th:block th:include="~{fragments/navbar}"></th:block>
</header>
<main>
    <div class="container-fluid d-flex flex-column align-items-center w-75">
        <div class="card text-center m-2" style="width: 26rem;">
            <div th:object="${car}" class="card-body">
                <h5 class="card-title" th:text="|*{make} *{carModel}|"> Astra</h5>
                <div class="container">
                    <div class="row">
                        <div class="col-sm" th:text="*{carCondition}">
                            USED
                        </div>
                        <div class="col-sm"th:text="*{year}"></div>
                        <div class="col-sm" th:text="|*{mileage} km|"></div>

                    </div>
                    <div class="row">
                        <h5 class="col-sm" th:text="|*{price} BGN|">
                            15 BGN
                        </h5>
                    </div>


                        <a th:href="@{/offers/add/{id}(id=${car.id})}" class="btn btn-outline-dark">Get a quote</a>

                </div>
            </div>
        </div>

        <h4>Your offers</h4>
        <table class="table">
            <thead>
            <tr>
                <th scope="col">#</th>
                <th scope="col">Deposit %</th>
                <th scope="col">Term (months)</th>
                <th scope="col">Residual value %</th>
                <th scope="col">Request Date</th>
                <th scope="col">Status</th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
            <th:block th:each="offer, iter: ${offers}" th:object="${offer}">
                <tr>
                    <td scope="row" th:text="|${iter.index + 1}|"></td>
                    <td th:text="*{deposit}"></td>
                    <td th:text="*{term}"></td>
                    <td th:text="*{residualValue}"></td>
                    <td th:text="*{#temporals.format(requestDate, 'dd-MM-yyyy HH:mm')}"></td>
                    <td th:text="*{status}"></td>
                    <th:block sec:authorize="!hasRole('ROLE_MODERATOR')">
                    <td th:if="${offer.status == 'PRESENTED' or offer.status == 'REVISED'}"><a class="btn btn-light" th:href="@{/seller/add/{id}(id=${offer.id})}">Apply for leasing</a></td>
                    </th:block>
                    <th:block sec:authorize="hasRole('ROLE_MODERATOR')">
                    <td><a th:href="@{/offers/edit/{id}(id=${offer.id})}" class="btn btn-outline-dark">Review</a></td>
                    <td th:if="${offer.status != 'APPLIED'}">
<!--                        <a th:href="@{/offers/delete/{id}(id=${offer.id})}" class="btn btn-outline-dark">Delete</a>-->
                        <form th:action="@{/offers/delete}" th:method="delete">
                            <div class="button-holder d-flex justify-content-center">
                                <input type="hidden" name="id" th:value="*{id}">
                                <button type="submit" class="btn btn-danger">Delete</button>
                            </div>
                        </form>
                    </td>
                    </th:block>
                </tr>
            </th:block>
            </tbody>
        </table>
        <th:block sec:authorize="hasRole('ROLE_MODERATOR')">
            <img th:src="${car.offerUrl}" target="_blank" rel="noopener noreferrer" alt="Car offer">
            <img th:src="${page2}" alt="">
            <img th:src="${page3}" alt="">
            <img th:src="${page4}" alt="">
        </th:block>

    </div>
</main>
</body>
</html>